# Mobile forensics CTF 2023


## FDE 20

> What was the key derivation function on Android until version 4.4?

**Flag:** `PBKDF2`

## Secure ADB 10

> In which Android version was Secure USB Debugging introduced?

**Flag:** `4.2.2`

## Database 10

> Which type are the databases used by most mobile apps on Android?

**Flag:** `sqlite`

## Apps 20

> In which file can you find the information regarding requested permissions and registered broadcast receiver within an Android App?

**Flag:** `AndroidManifest.xml`

## Screenlock 30

> In which file is the hash of the used screenlock pattern stored on Android devices?

**Flag:** `gesture.key`

## Code Name 20

> What is the code name for Android 4.4?

**Flag:** `KitKat`

## System 20

> How is the secure environment on iOS called that handles encryption keys?

**Flag:** `Secure Enclave`

## Encryption 40

 > What is the most secure encryption option on iOS?
 
 **Flag:** `NSFileProtectionComplete`
 
## System 20

> How is the database called that stores sensitive data like credentials on iOS?

**Flag:** `Keychain`

## System 40

> How is the vulnerability called that allows to get root access to a large amount of iOS devices?

**Flag:** `checkm8`

## Timing 30

> Which date is 717003710234?
> (Format DD.MM.YY-hh:mm:ss)

**Flag:** 30.07.17 17:20:43

## Timing 20

> What is May 1st 2019, 16:20:03 in reverse nibble? (without spaces or any other symbol)

Use Dcode to convert it.

**Flag:** `915010610230`

## Law 20

> The European Union issued a directive to harmonize regulations in EU member states concerning the retention of data generated by publicly available electronic communications services. How is this directive called?
We don’t want to have the name, just the ID.

**Flag:** `2006/24/EC`

## IDs 10

> How is the unique 15 digits long identifier of a mobile device called?

**Flag:** `IMEI`

## IDs 10

> How is the unique identifier for a SIM card on the network called?

**Flag:** `IMSI`

## Staircase 100

 > Which of the following is the step within the investigative process model that needs to be adopted when dealing with smartphones?
 
 **Flag:** `Preservation`
 
## Screenlock 50

> What is the pattern of the device this file is from?
> (submit the numbers of the connected bullets without spaces or other symbols in between)

```python
>>> open('gesture.key', 'rb').read().encode('hex')
'6a062b9b3452e366407181a1bf92ea73e9ed4c48'
```

Look for this hash in the table.

**Flag:** `0124678`
 
## Screenlock 150

> What was the PIN for the following hash and salt?

```bash
$ python .\crack_screenlock_pin_offline.py .
$ hashcat.exe -a 3 -m 110 .\crack.hash -1 ?d ?1?1?1?1
$ crack.hash: 61E5BD562F610EC77D7A36ED34F11D7D6B2B85B5:b2e3abe32f90ef8e
```
 
**Flag:** `4711`

## Name 50	

> What was the name of the corresponding iOS device?

View preferences.plist with a proper viewer like https://github.com/TingPing/plist-viewer

**Flag:** `Test-iPhone`

## App 300

> We found an app on a victim device that stores potential interesting data encrypted within its own database. When looking at the app we see that a PIN code is needed [1]. After analyzing the sourcecode of the app, we know, that the md5 of the PIN is stored within the plist-file of the app and that the PIN can have between 1 and 5 characters. From there we got the following hash: 249a20aaf20e385fbaad2bcadade5c4e
> What was the original PIN the user used?

```bash
$ hash.txt: 249a20aaf20e385fbaad2bcadade5c4e
$ hashcat.exe -a 3 -m 0 .\hash.txt ?d0?d0?d0?d0?d0
```

**Flag:** `1030308080`

## PDU 250

> What was the original message for the PDU encoded message CD6AD13944169D?

Use something like https://github.com/qotto/smspdudecoder

>>> from smspdudecoder.codecs import GSM, UCS2
>>> GSM.decode('CD6AD13944169D')

**Flag:** `MUENCHEN`

## PDU 200

> What is the PDU encoded value of “FORENSIK” (in HEX without spaces or 0x)

>>> GSM.encode('FORENSIK')

**Flag:** `C6A7B4E89C2697`

## ICCID 50

> What is the unique serial number of the following ICCID: 89490120420139348761

**Flag:** 13934876